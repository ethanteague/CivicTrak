{#
/**
 * @file
 * Template for the Permits and Forms block.
 *
 * Available variables:
 * - forms: Array of form data including title, description, url, etc.
 */
#}

<div class="permits-forms-section">
  <div class="container">
    
    <!-- Header Section -->
    <div class="row mb-5">
      <div class="col-12">
        <div class="section-header text-center">
          <h2 class="display-4 mb-3">üìã Permits & Forms</h2>
          <p class="lead text-muted">Access city applications, permits, and services online. Submit forms 24/7 and track your requests.</p>
          <div class="header-stats row justify-content-center mt-4">
            <div class="col-md-3 col-6">
              <div class="stat-item">
                <h3 class="text-primary">12</h3>
                <p class="mb-0">Online Forms</p>
              </div>
            </div>
            <div class="col-md-3 col-6">
              <div class="stat-item">
                <h3 class="text-success">24/7</h3>
                <p class="mb-0">Available</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Tabs -->
    <div class="row mb-4">
      <div class="col-12">
        <ul class="nav nav-pills nav-fill filter-tabs" id="category-filter" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="all-tab" data-bs-toggle="pill" data-bs-target="#all" type="button" role="tab">
              All Forms
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="permits-tab" data-bs-toggle="pill" data-bs-target="#permits" type="button" role="tab">
              üèóÔ∏è Permits
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="services-tab" data-bs-toggle="pill" data-bs-target="#services" type="button" role="tab">
              üõ†Ô∏è Services
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="forms-tab" data-bs-toggle="pill" data-bs-target="#forms" type="button" role="tab">
              üìÑ Applications
            </button>
          </li>
        </ul>
      </div>
    </div>

    <!-- Forms Grid -->
    <div class="tab-content" id="forms-content">
      
      <!-- All Forms Tab -->
      <div class="tab-pane fade show active" id="all" role="tabpanel">
        <div class="row">
          {% for form in forms %}
            <div class="col-lg-4 col-md-6 mb-4 d-flex">
              <div class="form-card h-100 shadow-sm border-0">
                <div class="card-body d-flex flex-column">
                  <div class="form-header d-flex align-items-center mb-3">
                    <div class="form-icon me-3">
                      <span class="icon-circle">{{ form.icon }}</span>
                    </div>
                    <div class="form-meta flex-grow-1">
                      <h5 class="card-title mb-1">{{ form.title }}</h5>
                      <span class="badge bg-{{ form.category == 'Permits' ? 'primary' : (form.category == 'Services' ? 'success' : 'info') }} category-badge">
                        {{ form.category }}
                      </span>
                    </div>
                  </div>
                  
                  <p class="card-text text-muted mb-3 flex-grow-1">{{ form.description }}</p>
                  
                  <div class="form-details mb-3">
                    <div class="detail-item d-flex justify-content-between mb-2">
                      <span class="detail-label">‚è±Ô∏è Processing:</span>
                      <span class="detail-value">{{ form.processing_time }}</span>
                    </div>
                    <div class="detail-item d-flex justify-content-between mb-2">
                      <span class="detail-label">üí∞ Fee:</span>
                      <span class="detail-value">{{ form.fee }}</span>
                    </div>
                  </div>
                  
                  <div class="requirements mb-3">
                    <h6 class="requirements-title">üìã Requirements:</h6>
                    <ul class="requirements-list">
                      {% for requirement in form.requirements %}
                        <li>{{ requirement }}</li>
                      {% endfor %}
                    </ul>
                  </div>
                </div>
                
                <div class="card-footer bg-transparent border-0 pt-0 mt-auto">
                  <a href="#form-coming-soon" class="btn btn-primary btn-block w-100" data-bs-toggle="modal">
                    Start Application ‚Üí
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Help Section -->
    <div class="row mt-5">
      <div class="col-12">
        <div class="help-section p-4 rounded">
          <div class="row">
            <div class="col-md-8">
              <h4>Need Help with Forms?</h4>
              <p class="mb-0">Our staff is available to assist you with applications and answer questions about city services.</p>
            </div>
            <div class="col-md-4 text-md-end">
              <div class="contact-info">
                <p class="mb-1"><strong>üìû (555) 123-4567</strong></p>
                <p class="mb-1">üìß permits@cityname.gov</p>
                <p class="mb-0">üïí Mon-Fri: 8 AM - 5 PM</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Modal for Coming Soon -->
<div class="modal fade" id="form-coming-soon" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">üöÄ Coming Soon!</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <div class="mb-4">
          <div class="icon-circle mx-auto mb-3" style="width: 80px; height: 80px; font-size: 2rem;">üèóÔ∏è</div>
          <h4>Online Forms Coming Soon</h4>
          <p class="text-muted">We're building a comprehensive online forms system to make it easier for citizens to access city services.</p>
        </div>
        <div class="alert alert-info">
          <strong>In the meantime:</strong><br>
          Please call (555) 123-4567 or visit City Hall<br>
          Monday-Friday, 8 AM - 5 PM
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <a href="tel:555-123-4567" class="btn btn-primary">üìû Call Now</a>
      </div>
    </div>
  </div>
</div>

<style>
.permits-forms-section {
  padding: 2rem 0;
  background: #f8f9fa;
}

.permits-forms-section .container {
  max-width: 1200px;
}

.section-header {
  background: white;
  padding: 3rem 2rem;
  border-radius: 15px;
  margin-bottom: 3rem;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.section-header .stat-item {
  text-align: center;
  padding: 1.5rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 12px;
  color: white;
  margin: 0 0.5rem;
}

.section-header .stat-item h3 {
  font-size: 2.5rem;
  font-weight: bold;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Ensure equal height cards */
.row {
  display: flex;
  flex-wrap: wrap;
}

.form-card {
  transition: all 0.2s ease;
  border-radius: 15px;
  border: 1px solid #e9ecef;
  background: white;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.form-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 40px rgba(0,0,0,0.15) !important;
  border-color: #667eea;
}

.form-card .card-body {
  padding: 2rem;
  flex-grow: 1;
  display: flex;
  flex-direction: column;
}

.form-header {
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid #f1f3f4;
}

.form-icon .icon-circle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 50%;
  font-size: 1.8rem;
  color: white;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.form-meta h5 {
  font-size: 1.25rem;
  font-weight: 600;
  color: #2c3e50;
  margin-bottom: 0.5rem;
  line-height: 1.3;
}

.category-badge {
  font-size: 0.75rem;
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.card-text {
  font-size: 0.95rem;
  line-height: 1.6;
  color: #5a6c7d;
  margin-bottom: 1.5rem;
}

.form-details {
  background: #f8f9fa;
  padding: 1.5rem;
  border-radius: 10px;
  margin-bottom: 1.5rem;
}

.detail-item {
  font-size: 0.9rem;
  padding: 0.5rem 0;
  border-bottom: 1px solid #e9ecef;
}

.detail-item:last-child {
  border-bottom: none;
}

.detail-label {
  color: #6c757d;
  font-weight: 500;
}

.detail-value {
  font-weight: 600;
  color: #495057;
}

.requirements {
  background: #fff3cd;
  padding: 1.5rem;
  border-radius: 10px;
  border-left: 4px solid #ffc107;
  margin-bottom: 1.5rem;
}

.requirements-title {
  font-size: 1rem;
  font-weight: 600;
  color: #856404;
  margin-bottom: 1rem;
}

.requirements-list {
  font-size: 0.9rem;
  color: #856404;
  margin-bottom: 0;
  padding-left: 1.2rem;
}

.requirements-list li {
  margin-bottom: 0.5rem;
  position: relative;
}

.requirements-list li::marker {
  color: #ffc107;
}

.card-footer {
  padding: 0 2rem 2rem 2rem;
  margin-top: auto;
}

.btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border: none;
  padding: 1rem 2rem;
  font-weight: 600;
  border-radius: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  transition: all 0.2s ease;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
  background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
}

.filter-tabs {
  background: white;
  padding: 1rem;
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  margin-bottom: 2rem;
}

.filter-tabs .nav-link {
  border-radius: 25px;
  font-weight: 500;
  margin: 0 0.25rem;
  padding: 0.75rem 1.5rem;
  transition: all 0.2s ease;
  border: 2px solid transparent;
}

.filter-tabs .nav-link:hover {
  background: #f8f9fa;
  transform: translateY(-1px);
}

.filter-tabs .nav-link.active {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border: none;
  color: white;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.help-section {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 2.5rem;
  border-radius: 15px;
  border: none;
  box-shadow: 0 8px 30px rgba(102, 126, 234, 0.3);
}

.help-section h4 {
  color: white;
  font-weight: 600;
}

.help-section p {
  color: rgba(255,255,255,0.9);
}

.contact-info p {
  color: white;
  font-weight: 500;
}

/* Modal styles */
.modal .icon-circle {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: white;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .section-header {
    padding: 2rem 1rem;
  }
  
  .section-header .header-stats {
    margin-top: 2rem;
  }
  
  .section-header .stat-item {
    margin: 0.5rem 0;
  }
  
  .form-card .card-body {
    padding: 1.5rem;
  }
  
  .filter-tabs .nav-link {
    font-size: 0.9rem;
    padding: 0.5rem 1rem;
    margin: 0.25rem;
  }
  
  .help-section {
    padding: 2rem 1.5rem;
  }
}

/* Ensure consistent card heights on larger screens */
@media (min-width: 992px) {
  .col-lg-4 {
    height: auto;
  }
  
  .form-card {
    min-height: 650px;
  }
}

@media (min-width: 768px) and (max-width: 991px) {
  .form-card {
    min-height: 600px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Filter functionality
  const filterTabs = document.querySelectorAll('#category-filter .nav-link');
  const formCards = document.querySelectorAll('.form-card');
  
  filterTabs.forEach(tab => {
    tab.addEventListener('click', function() {
      const filter = this.id.replace('-tab', '');
      
      formCards.forEach(card => {
        const category = card.querySelector('.category-badge').textContent.trim();
        
        if (filter === 'all' || 
            (filter === 'permits' && category === 'Permits') ||
            (filter === 'services' && category === 'Services') ||
            (filter === 'forms' && category === 'Forms')) {
          card.closest('.col-lg-4').style.display = 'block';
        } else {
          card.closest('.col-lg-4').style.display = 'none';
        }
      });
    });
  });
});
</script>